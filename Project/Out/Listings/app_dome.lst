C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE APP_DOME
OBJECT MODULE PLACED IN .\Out\Objects\app_dome.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\App\src\app_dome.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Common\in
                    -c;..\App\inc;..\Bsp\inc;..\Startup;..\Bsp) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Out\Listings\app_dome.lst) OBJ
                    -ECT(.\Out\Objects\app_dome.obj)

line level    source

   1          /*
   2           * app_dome.c
   3           *
   4           *  Created on: 2017Äê9ÔÂ8ÈÕ
   5           *      Author: fly
   6           */
   7          
   8          #include "app.h"
   9          #include <stdlib.h>
  10          
  11          static idata SUBDOME_T subDome;
  12          static DOME_HEADER_T domeHeader;
  13          static SUBDOME_ASSIST_T subDome_Assist;
  14          static DOME_PRO_T domePro;
  15          ///////////////////
  16          
  17          code const DOME_DEFAULT_T dome_default[DEFAULT_DOME_NUM] = {  //
  18                          { //start big dome0
  19                                          {  //start header0
  20                                                          "    DOME", 1  //header0 body
  21                                                          },//end header0
  22                                                          {  //start dome0
  23                                                                          { 0x05, { 255, 255, 255 }, { 0, 0, 0 }, 1, 200,
  24                                                                                          100, 0 }, //subdome0
  25                                                                          { 0x14, { 255, 0, 0 }, { 0, 0, 0 }, 1, 200, 100,
  26                                                                                          0 },  //subdome1
  27                                                                          { 0x24, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  28                                                                                          0 },  //subdome2
  29                                                                          { 0x34, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  30                                                                                          0 },   //subdome3
  31                                                                          { 0x44, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  32                                                                                          0 },  //subdome4
  33                                                                          { 0x54, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  34                                                                                          0 },  //subdome5
  35                                                                          { 0x64, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  36                                                                                          0 },  //subdome6
  37                                                                          { 0x74, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  38                                                                                          0 }    //subdome7
  39                                                          }  //end dome0
  40                                          },  // end big dome0
  41                                          { //start big dome1
  42                                          {  //start header0
  43                                                          "     LSU", 2 }, //end header0
  44                                                          {  //start dome0
  45                                                          { 0x03, { 160, 32, 240 }, { 255, 165, 0 }, 1, 200, 100,
  46                                                                          0 }, //subdome0
  47                                                                          { 0x13, { 255, 165, 0 }, { 160, 32, 240 }, 1,
  48                                                                                          200, 100, 0 },  //subdome1
  49                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  50                                                                                          0 },  //subdome2
  51                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  52                                                                                          0 },   //subdome3
  53                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 2   

  54                                                                                          0 },  //subdome4
  55                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  56                                                                                          0 },  //subdome5
  57                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  58                                                                                          0 },  //subdome6
  59                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  60                                                                                          0 }    //subdome7
  61          
  62                                                          }  //end dome0
  63                                          },  // end big dome1
  64                                          { //start big dome2
  65                                          {  //start header0
  66                                                          "    XMAS", 3 }, //end header0
  67                                                          {  //start dome0
  68                                                          { 0x03, { 255, 0, 0 }, { 0, 255, 0 }, 1, 200, 100, 0 }, //subdome0
  69                                                                          { 0x13, { 0, 255, 0 }, { 255, 255, 255 }, 1,
  70                                                                                          200, 100, 0 },  //subdome1
  71                                                                          { 0x23, { 255, 255, 255 }, { 255, 0, 0 }, 1,
  72                                                                                          200, 100, 0 },  //subdome2
  73                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  74                                                                                          0 },   //subdome3
  75                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  76                                                                                          0 },  //subdome4
  77                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  78                                                                                          0 },  //subdome5
  79                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  80                                                                                          0 },  //subdome6
  81                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  82                                                                                          0 }    //subdome7
  83          
  84                                                          }  //end dome0
  85                                          },  // end big dome2
  86                                          { //start big dome3
  87                                          {  //start header0
  88                                                          "   MARDI", 4 }, //end header0
  89                                                          {  //start dome0
  90                                                          { 0x03, { 255, 0, 0 }, { 0, 255, 0 }, 1, 100, 100, 0 }, //subdome0
  91                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
  92                                                                                          100, 0 },  //subdome1
  93                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
  94                                                                                          100, 100, 0 },  //subdome2
  95                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
  96                                                                                          100, 0 },   //subdome3
  97                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  98                                                                                          0 },  //subdome4
  99                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 100                                                                                          0 },  //subdome5
 101                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 102                                                                                          0 },  //subdome6
 103                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 104                                                                                          0 }    //subdome7
 105          
 106                                                          }  //end dome0
 107                                          },  // end big dome3
 108                                          { //start big dome4
 109                                          {  //start header0
 110                                                          "   FADE1", 1 }, //end header0
 111                                                          {  //start dome0
 112                                                          { 0x04, { 255, 0, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 113                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 114                                                                                          100, 0 },  //subdome1
 115                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 3   

 116                                                                                          100, 100, 0 },  //subdome2
 117                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 118                                                                                          100, 0 },   //subdome3
 119                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 120                                                                                          0 },  //subdome4
 121                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 122                                                                                          0 },  //subdome5
 123                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 124                                                                                          0 },  //subdome6
 125                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 126                                                                                          0 }    //subdome7
 127          
 128                                                          }  //end dome0
 129                                          },  // end big dome4
 130                                          { //start big dome4
 131                                          {  //start header0
 132                                                          "   FADE2", 1 }, //end header0
 133                                                          {  //start dome0
 134                                                          { 0x04, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 135                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 136                                                                                          100, 0 },  //subdome1
 137                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 138                                                                                          100, 100, 0 },  //subdome2
 139                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 140                                                                                          100, 0 },   //subdome3
 141                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 142                                                                                          0 },  //subdome4
 143                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 144                                                                                          0 },  //subdome5
 145                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 146                                                                                          0 },  //subdome6
 147                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 148                                                                                          0 }    //subdome7
 149          
 150                                                          }  //end dome0
 151                                          }, // end big dome4
 152                                          { //start big dome4
 153                                          {  //start header0
 154                                                          "   FADE3", 1 }, //end header0
 155                                                          {  //start dome0
 156                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 157                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 158                                                                                          100, 0 },  //subdome1
 159                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 160                                                                                          100, 100, 0 },  //subdome2
 161                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 162                                                                                          100, 0 },   //subdome3
 163                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 164                                                                                          0 },  //subdome4
 165                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 166                                                                                          0 },  //subdome5
 167                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 168                                                                                          0 },  //subdome6
 169                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 170                                                                                          0 }    //subdome7
 171          
 172                                                          }  //end dome0
 173                                          },  // end big dome4
 174                                          { //start big dome4
 175                                          {  //start header0
 176                                                          "   FADE4", 1 }, //end header0
 177                                                          {  //start dome0
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 4   

 178                                                          { 0x04, { 160, 32, 240 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 179                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 180                                                                                          100, 0 },  //subdome1
 181                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 182                                                                                          100, 100, 0 },  //subdome2
 183                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 184                                                                                          100, 0 },   //subdome3
 185                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 186                                                                                          0 },  //subdome4
 187                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 188                                                                                          0 },  //subdome5
 189                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 190                                                                                          0 },  //subdome6
 191                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 192                                                                                          0 }    //subdome7
 193          
 194                                                          }  //end dome0
 195                                          },  // end big dome4
 196                                          { //start big dome4
 197                                          {  //start header0
 198                                                          "   FADE5", 1 }, //end header0
 199                                                          {  //start dome0
 200                                                          { 0x04, { 255, 165, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 201                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 202                                                                                          100, 0 },  //subdome1
 203                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 204                                                                                          100, 100, 0 },  //subdome2
 205                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 206                                                                                          100, 0 },   //subdome3
 207                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 208                                                                                          0 },  //subdome4
 209                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 210                                                                                          0 },  //subdome5
 211                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 212                                                                                          0 },  //subdome6
 213                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 214                                                                                          0 }    //subdome7
 215          
 216                                                          }  //end dome0
 217                                          },  // end big dome4
 218                                          { //start big dome4
 219                                          {  //start header0
 220                                                          "  SHARP1", 1 }, //end header0
 221                                                          {  //start dome0
 222                                                          { 0x05, { 255, 0, 0 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 223                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 224                                                                                          100, 0 },  //subdome1
 225                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 226                                                                                          100, 100, 0 },  //subdome2
 227                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 228                                                                                          100, 0 },   //subdome3
 229                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 230                                                                                          0 },  //subdome4
 231                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 232                                                                                          0 },  //subdome5
 233                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 234                                                                                          0 },  //subdome6
 235                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 236                                                                                          0 }    //subdome7
 237          
 238                                                          }  //end dome0
 239                                          },  // end big dome4
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 5   

 240                                          { //start big dome4
 241                                          {  //start header0
 242                                                          "  SHARP2", 1 }, //end header0
 243                                                          {  //start dome0
 244                                                          { 0x05, { 0, 255, 0 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 245                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 246                                                                                          100, 0 },  //subdome1
 247                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 248                                                                                          100, 100, 0 },  //subdome2
 249                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 250                                                                                          100, 0 },   //subdome3
 251                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 252                                                                                          0 },  //subdome4
 253                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 254                                                                                          0 },  //subdome5
 255                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 256                                                                                          0 },  //subdome6
 257                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 258                                                                                          0 }    //subdome7
 259          
 260                                                          }  //end dome0
 261                                          }, // end big dome4
 262                                          { //start big dome4
 263                                          {  //start header0
 264                                                          "  SHARP3", 1 }, //end header0
 265                                                          {  //start dome0
 266                                                          { 0x05, { 0, 0, 255 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 267                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 268                                                                                          100, 0 },  //subdome1
 269                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 270                                                                                          100, 100, 0 },  //subdome2
 271                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 272                                                                                          100, 0 },   //subdome3
 273                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 274                                                                                          0 },  //subdome4
 275                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 276                                                                                          0 },  //subdome5
 277                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 278                                                                                          0 },  //subdome6
 279                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 280                                                                                          0 }    //subdome7
 281          
 282                                                          }  //end dome0
 283                                          },  // end big dome4
 284                                          { //start big dome4
 285                                          {  //start header0
 286                                                          "  SHARP4", 1 }, //end header0
 287                                                          {  //start dome0
 288                                                          { 0x05, { 160, 32, 240 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 289                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 290                                                                                          100, 0 },  //subdome1
 291                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 292                                                                                          100, 100, 0 },  //subdome2
 293                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 294                                                                                          100, 0 },   //subdome3
 295                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 296                                                                                          0 },  //subdome4
 297                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 298                                                                                          0 },  //subdome5
 299                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 300                                                                                          0 },  //subdome6
 301                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 6   

 302                                                                                          0 }    //subdome7
 303          
 304                                                          }  //end dome0
 305                                          },  // end big dome4
 306                                          { //start big dome4
 307                                          {  //start header0
 308                                                          "  SHARP5", 1 }, //end header0
 309                                                          {  //start dome0
 310                                                                          { 0x05, { 255, 165, 0 }, { 0, 0, 0 }, 1, 100,
 311                                                                                          100, 100 }, //subdome0
 312                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 313                                                                                          100, 100 },  //subdome1
 314                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 315                                                                                          100, 100, 100 },  //subdome2
 316                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 317                                                                                          100, 0 },   //subdome3
 318                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 319                                                                                          0 },  //subdome4
 320                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 321                                                                                          0 },  //subdome5
 322                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 323                                                                                          0 },  //subdome6
 324                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 325                                                                                          0 }    //subdome7
 326          
 327                                                          }  //end dome0
 328                                          }, // end big dome4
 329                                          { //start big dome4
 330                                          {  //start header0
 331                                                          " GRADIEN", 7 }, //end header0
 332                                                          {  //start dome0
 333                                                                          { 0x03, { 255, 0, 0 }, { 255, 0x7F, 0 }, 1, 100,
 334                                                                                          100, 0 }, //subdome0
 335                                                                          { 0x13, { 255, 0x7F, 0 }, { 255, 255, 0 }, 1,
 336                                                                                          100, 100, 0 },  //subdome1
 337                                                                          { 0x23, { 255, 255, 0 }, { 0, 255, 0 }, 1, 100,
 338                                                                                          100, 0 },  //subdome2
 339                                                                          { 0x33, { 0, 255, 0 }, { 0, 255, 255 }, 1, 100,
 340                                                                                          100, 0 },   //subdome3
 341                                                                          { 0x43, { 0, 255, 255 }, { 0, 0, 255 }, 1, 100,
 342                                                                                          100, 0 },  //subdome4
 343                                                                          { 0x53, { 0, 0, 255 }, { 0x8B, 0, 255 }, 1, 100,
 344                                                                                          100, 0 },  //subdome5
 345                                                                          { 0x63, { 0x8B, 0, 255 }, { 255, 0, 0 }, 1, 100,
 346                                                                                          100, 0 },  //subdome6
 347                                                                          { 0x73, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 348                                                                                          0 }    //subdome7
 349          
 350                                                          }  //end dome0
 351                                          }  // end big dome4
 352                          };
 353          
 354          //////////////////
 355          void app_dome_start(uint8_t index);
 356          void app_dome_Init(void) {
 357   1      
 358   1              memset((uint8_t *) &subDome_Assist, 0, sizeof(subDome_Assist));
 359   1      
 360   1              memset((uint8_t *) &domePro, 0, sizeof(domePro));
 361   1      
 362   1              app_dome_start(0);
 363   1      
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 7   

 364   1      }
 365          void app_dome_previous(void) {
 366   1              if (domePro.currentDomeIndex) {
 367   2                      domePro.currentDomeIndex--;
 368   2              } else {
 369   2                      domePro.currentDomeIndex = DEFAULT_DOME_NUM - 1;
 370   2              }
 371   1              app_dome_start(domePro.currentDomeIndex);
 372   1      }
 373          void app_dome_next(void) {
 374   1              domePro.currentDomeIndex++;
 375   1              if (domePro.currentDomeIndex >= DEFAULT_DOME_NUM) {
 376   2                      domePro.currentDomeIndex = 0;
 377   2              }
 378   1      
 379   1              app_dome_start(domePro.currentDomeIndex);
 380   1      
 381   1      }
 382          
 383          void app_dome_get_current_Name(char *name, uint8_t len) {
 384   1              if (len > sizeof(dome_default[domePro.currentDomeIndex].header.name)) {
 385   2                      name = 0;
 386   2                      return;
 387   2              }
 388   1              memcpy((uint8_t *) name,
 389   1                              (uint8_t *) dome_default[domePro.currentDomeIndex].header.name,
 390   1                              len);
 391   1      }
 392          void app_dome_start_current(void) {
 393   1      
 394   1              app_dome_start(domePro.currentDomeIndex);
 395   1      
 396   1      }
 397          void app_dome_stop_current(void) {
 398   1      
 399   1              subDome.repeate = 0;
 400   1              subDome.offtime = 0;
 401   1              Light_RGB_set(0, 0, 0);
 402   1      
 403   1      }
 404          void app_dome_single_cycle(uint8_t subIndex) {
 405   1              if (dome_default[domePro.currentDomeIndex].header.number
 406   1                              == (subIndex + 1)) {
 407   2                      subIndex = 0;
 408   2                      memcpy((uint8_t*) &subDome,
 409   2                                      (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[subIndex],
 410   2                                      sizeof(subDome));
 411   2              } else {
 412   2                      memcpy((uint8_t*) &subDome,
 413   2                                      (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[subIndex
 414   2                                                      + 1], sizeof(subDome));
 415   2              }
 416   1      
 417   1              memcpy((uint8_t*) &domeHeader,
 418   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].header,
 419   1                              sizeof(domeHeader));
 420   1      
 421   1      }
 422          void app_dome_start(uint8_t domeIndex) {
 423   1              subDome_Assist.switch_flag = 0;
 424   1              subDome_Assist.msCnt = 0;
 425   1              subDome_Assist.stopTime = 50;
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 8   

 426   1      
 427   1      //      app_dome_single_cycle(domeIndex);
 428   1      
 429   1              domePro.currentDomeIndex = domeIndex;
 430   1      
 431   1              memcpy((uint8_t*) &subDome,
 432   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[0],
 433   1                              sizeof(subDome));
 434   1      
 435   1              memcpy((uint8_t*) &domeHeader,
 436   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].header,
 437   1                              sizeof(domeHeader));
 438   1      
 439   1      }
 440          
 441          static void app_dome_subDome_pro(uint8_t subIndex) {
 442   1              subDome_Assist.switch_flag = 0;
 443   1              subDome_Assist.msCnt = 0;
 444   1              subDome_Assist.stopTime = 0;
 445   1      
 446   1              app_dome_single_cycle(subIndex);
 447   1      
 448   1      }
 449          
 450          static uint32_t tmp = 0;
 451          static uint8_t tmp_color = 0;
 452          
 453          void app_dome_interrupter(void) {
 454   1      
 455   1      #if 1
 456   1      
 457   1              if (subDome_Assist.stopTime) {
 458   2                      subDome_Assist.stopTime--;
 459   2                      return;
 460   2              }
 461   1      
 462   1              if ((subDome.repeate == 0) && (subDome.offtime == 0)) {
 463   2                      return;
 464   2              }
 465   1      
 466   1              switch (subDome.mode & 0x0F) {
 467   2              case 0x03:  //shadow
 468   2              {
 469   3                      subDome_Assist.msCnt++;
 470   3                      if (subDome.color1.R < subDome.color2.R) {
 471   4                              tmp = subDome.color1.R * 256
 472   4                                              + subDome_Assist.msCnt * 256
 473   4                                                              * abs(subDome.color2.R - subDome.color1.R)
 474   4                                                              / subDome.speed;
 475   4                              tmp = subDome.bright * tmp / 100;
 476   4                              Light_Red_set(tmp & 0xFFFF);
 477   4                      } else {
 478   4                              tmp = subDome.color1.R * 256
 479   4                                              - subDome_Assist.msCnt * 256
 480   4                                                              * abs(subDome.color2.R - subDome.color1.R)
 481   4                                                              / subDome.speed;
 482   4                              tmp = subDome.bright * tmp / 100;
 483   4                              Light_Red_set(tmp);
 484   4                      }
 485   3                      //////
 486   3                      if (subDome.color1.G < subDome.color2.G) {
 487   4                              tmp = subDome.color1.G * 256
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 9   

 488   4                                              + subDome_Assist.msCnt * 256
 489   4                                                              * abs(subDome.color2.G - subDome.color1.G)
 490   4                                                              / subDome.speed;
 491   4                              tmp = subDome.bright * tmp / 100;
 492   4                              Light_Green_set(tmp);
 493   4                      } else {
 494   4                              tmp = subDome.color1.G * 256
 495   4                                              - subDome_Assist.msCnt * 256
 496   4                                                              * abs(subDome.color2.G - subDome.color1.G)
 497   4                                                              / subDome.speed;
 498   4                              tmp = subDome.bright * tmp / 100;
 499   4                              Light_Green_set(tmp);
 500   4                      }
 501   3                      //////
 502   3                      if (subDome.color1.B < subDome.color2.B) {
 503   4                              tmp = subDome.color1.B * 256
 504   4                                              + subDome_Assist.msCnt * 256
 505   4                                                              * abs(subDome.color2.B - subDome.color1.B)
 506   4                                                              / subDome.speed;
 507   4                              tmp = subDome.bright * tmp / 100;
 508   4                              Light_Blue_set(tmp);
 509   4                      } else {
 510   4                              tmp = subDome.color1.B * 256
 511   4                                              - subDome_Assist.msCnt * 256
 512   4                                                              * abs(subDome.color2.B - subDome.color1.B)
 513   4                                                              / subDome.speed;
 514   4                              tmp = subDome.bright * tmp / 100;
 515   4                              Light_Blue_set(tmp);
 516   4                      }
 517   3      
 518   3                      if (subDome_Assist.msCnt >= subDome.speed) {
 519   4                              subDome_Assist.msCnt = 0;
 520   4      #if 0
                                      tmp_color = subDome.color2.R;
                                      subDome.color2.R = subDome.color1.R;
                                      subDome.color1.R = tmp_color;
              
                                      tmp_color = subDome.color2.G;
                                      subDome.color2.G = subDome.color1.G;
                                      subDome.color1.G = tmp_color;
              
                                      tmp_color = subDome.color2.B;
                                      subDome.color2.B = subDome.color1.B;
                                      subDome.color1.B = tmp_color;
              
                                      if (subDome_Assist.switch_flag == 0) {
                                              subDome_Assist.switch_flag = 1;
              
                                      } else {
                                              subDome_Assist.switch_flag = 0;
              
                                              if (subDome.repeate) {
                                                      subDome.repeate--;
                                              }
                                      }
              #else
 544   4      
 545   4                              if (subDome.repeate) {
 546   5                                      subDome.repeate--;
 547   5                              }
 548   4      
 549   4      #endif
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 10  

 550   4                      }
 551   3                      if (subDome.repeate == 0) {
 552   4      //                      Light_RGB_set(0, 0, 0);
 553   4      
 554   4                              if (subDome.offtime) {
 555   5                                      subDome.offtime--;
 556   5                              }
 557   4                              if (subDome.offtime == 0) {
 558   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 559   5                              }
 560   4      
 561   4                      }
 562   3              }
 563   2                      break;
 564   2              case 0x04:  //breath
 565   2              {
 566   3                      if (subDome_Assist.switch_flag == 0) {
 567   4                              subDome_Assist.msCnt++;
 568   4                      } else {
 569   4                              if (subDome_Assist.msCnt) {
 570   5                                      subDome_Assist.msCnt--;
 571   5                              }
 572   4                      }
 573   3      
 574   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.R / subDome.speed;
 575   3                      tmp = tmp * subDome.bright / 100;
 576   3                      Light_Red_set(tmp & 0xFFFF);
 577   3      
 578   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.G / subDome.speed;
 579   3                      tmp = tmp * subDome.bright / 100;
 580   3                      Light_Green_set(tmp & 0xFFFF);
 581   3      
 582   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.B / subDome.speed;
 583   3                      tmp = tmp * subDome.bright / 100;
 584   3                      Light_Blue_set(tmp & 0xFFFF);
 585   3      
 586   3                      if ((subDome_Assist.msCnt >= subDome.speed)
 587   3                                      || (subDome_Assist.msCnt == 0)) {
 588   4                              if (subDome_Assist.switch_flag == 0) {
 589   5                                      subDome_Assist.switch_flag = 1;
 590   5                              } else {
 591   5                                      subDome_Assist.switch_flag = 0;
 592   5                                      if (subDome.repeate) {
 593   6                                              subDome.repeate--;
 594   6                                      }
 595   5                              }
 596   4                      }
 597   3                      if (subDome.repeate == 0) {
 598   4      //                      Light_RGB_set(0, 0, 0);
 599   4                              if (subDome.offtime) {
 600   5                                      subDome.offtime--;
 601   5                              }
 602   4                              if (subDome.offtime == 0) {
 603   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 604   5                              }
 605   4                      }
 606   3              }
 607   2                      break;
 608   2              case 0x05:  //blink
 609   2              {
 610   3                      uint32_t tt = 0xFF;
 611   3                      if (subDome_Assist.msCnt == 0) {
C51 COMPILER V9.56.0.0   APP_DOME                                                          09/12/2017 01:20:21 PAGE 11  

 612   4                              tmp = tt * subDome.color1.R * subDome.bright / 100;
 613   4                              Light_Red_set(tmp & 0xFFFF);
 614   4      
 615   4                              tmp = tt * subDome.color1.G * subDome.bright / 100;
 616   4                              Light_Green_set(tmp & 0xFFFF);
 617   4      
 618   4                              tmp = tt * subDome.color1.B * subDome.bright / 100;
 619   4                              Light_Blue_set(tmp & 0xFFFF);
 620   4                      }
 621   3                      if (subDome_Assist.msCnt == (uint32_t) subDome.speed) {
 622   4                              tmp = tt * subDome.color2.R * subDome.bright / 100;
 623   4                              Light_Red_set(tmp & 0xFFFF);
 624   4      
 625   4                              tmp = tt * subDome.color2.G * subDome.bright / 100;
 626   4                              Light_Green_set(tmp & 0xFFFF);
 627   4      
 628   4                              tmp = tt * subDome.color2.B * subDome.bright / 100;
 629   4                              Light_Blue_set(tmp & 0xFFFF);
 630   4                      }
 631   3                      subDome_Assist.msCnt++;
 632   3                      if (subDome_Assist.msCnt >= (subDome.speed + subDome.offtime)) {
 633   4                              subDome_Assist.msCnt = 0;
 634   4      
 635   4                              if (subDome.repeate) {
 636   5                                      subDome.repeate--;
 637   5                              }
 638   4      
 639   4                      }
 640   3                      if (subDome.repeate == 0) {
 641   4      //                      Light_RGB_set(0, 0, 0);
 642   4                              if (subDome.offtime) {
 643   5                                      subDome.offtime--;
 644   5                              }
 645   4                              if (subDome.offtime == 0) {
 646   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 647   5                              }
 648   4                      }
 649   3              }
 650   2                      break;
 651   2              default:
 652   2      
 653   2                      break;
 654   2              }
 655   1      
 656   1      #endif
 657   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2801    ----
   CONSTANT SIZE    =   1695    ----
   XDATA SIZE       =     21       8
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =     13    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
