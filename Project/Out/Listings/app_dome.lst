C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE APP_DOME
OBJECT MODULE PLACED IN .\Out\Objects\app_dome.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\App\src\app_dome.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Common\in
                    -c;..\App\inc;..\Bsp\inc;..\Startup;..\Bsp) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Out\Listings\app_dome.lst) OBJ
                    -ECT(.\Out\Objects\app_dome.obj)

line level    source

   1          /*
   2           * app_dome.c
   3           *
   4           *  Created on: 2017Äê9ÔÂ8ÈÕ
   5           *      Author: fly
   6           */
   7          
   8          #include "app.h"
   9          #include <stdlib.h>
  10          
  11          static idata SUBDOME_T subDome;
  12          static DOME_HEADER_T domeHeader;
  13          static SUBDOME_ASSIST_T subDome_Assist;
  14          static DOME_PRO_T domePro;
  15          ///////////////////
  16          
  17          code const DOME_DEFAULT_T dome_default[DEFAULT_DOME_NUM] = {  //
  18                          { //start big dome0
  19                                          {  //start header0
  20                                                          "    DOME", 0, 0x01  //header0 body
  21                                                          },//end header0
  22                                                          {  //start dome0
  23                                                                          { 0x05, { 255, 255, 255 }, { 0, 0, 0 }, 1, 200,
  24                                                                                          100, 0 }, //subdome0
  25                                                                          { 0x14, { 255, 0, 0 }, { 0, 0, 0 }, 1, 200, 100,
  26                                                                                          0 },  //subdome1
  27                                                                          { 0x24, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  28                                                                                          0 },  //subdome2
  29                                                                          { 0x34, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  30                                                                                          0 },   //subdome3
  31                                                                          { 0x44, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  32                                                                                          0 },  //subdome4
  33                                                                          { 0x54, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  34                                                                                          0 },  //subdome5
  35                                                                          { 0x64, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  36                                                                                          0 },  //subdome6
  37                                                                          { 0x74, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100,
  38                                                                                          0 }    //subdome7
  39                                                          }  //end dome0
  40                                          },  // end big dome0
  41                                          { //start big dome1
  42                                          {  //start header0
  43                                                          "     LSU", 0, 0x02 }, //end header0
  44                                                          {  //start dome0
  45                                                          { 0x03, { 160, 32, 240 }, { 255, 165, 0 }, 1, 200, 100,
  46                                                                          0 }, //subdome0
  47                                                                          { 0x13, { 255, 165, 0 }, { 160, 32, 240 }, 1,
  48                                                                                          200, 100, 0 },  //subdome1
  49                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  50                                                                                          0 },  //subdome2
  51                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  52                                                                                          0 },   //subdome3
  53                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 2   

  54                                                                                          0 },  //subdome4
  55                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  56                                                                                          0 },  //subdome5
  57                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  58                                                                                          0 },  //subdome6
  59                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100,
  60                                                                                          0 }    //subdome7
  61          
  62                                                          }  //end dome0
  63                                          },  // end big dome1
  64                                          { //start big dome2
  65                                          {  //start header0
  66                                                          "    XMAS", 0, 0x03 }, //end header0
  67                                                          {  //start dome0
  68                                                          { 0x03, { 255, 0, 0 }, { 0, 255, 0 }, 1, 200, 100, 0 }, //subdome0
  69                                                                          { 0x13, { 0, 255, 0 }, { 255, 255, 255 }, 1,
  70                                                                                          200, 100, 0 },  //subdome1
  71                                                                          { 0x23, { 255, 255, 255 }, { 255, 0, 0 }, 1,
  72                                                                                          200, 100, 0 },  //subdome2
  73                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  74                                                                                          0 },   //subdome3
  75                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  76                                                                                          0 },  //subdome4
  77                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  78                                                                                          0 },  //subdome5
  79                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  80                                                                                          0 },  //subdome6
  81                                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  82                                                                                          0 }    //subdome7
  83          
  84                                                          }  //end dome0
  85                                          },  // end big dome2
  86                                          { //start big dome3
  87                                          {  //start header0
  88                                                          "   MARDI", 0, 0x04 }, //end header0
  89                                                          {  //start dome0
  90                                                          { 0x03, { 255, 0, 0 }, { 0, 255, 0 }, 1, 100, 100, 0 }, //subdome0
  91                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
  92                                                                                          100, 0 },  //subdome1
  93                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
  94                                                                                          100, 100, 0 },  //subdome2
  95                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
  96                                                                                          100, 0 },   //subdome3
  97                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
  98                                                                                          0 },  //subdome4
  99                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 100                                                                                          0 },  //subdome5
 101                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 102                                                                                          0 },  //subdome6
 103                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 104                                                                                          0 }    //subdome7
 105          
 106                                                          }  //end dome0
 107                                          },  // end big dome3
 108                                          { //start big dome4
 109                                          {  //start header0
 110                                                          "   FADE1", 0, 0x01 }, //end header0
 111                                                          {  //start dome0
 112                                                          { 0x04, { 255, 0, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 113                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 114                                                                                          100, 0 },  //subdome1
 115                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 3   

 116                                                                                          100, 100, 0 },  //subdome2
 117                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 118                                                                                          100, 0 },   //subdome3
 119                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 120                                                                                          0 },  //subdome4
 121                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 122                                                                                          0 },  //subdome5
 123                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 124                                                                                          0 },  //subdome6
 125                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 126                                                                                          0 }    //subdome7
 127          
 128                                                          }  //end dome0
 129                                          },  // end big dome4
 130                                          { //start big dome4
 131                                          {  //start header0
 132                                                          "   FADE2", 0, 0x01 }, //end header0
 133                                                          {  //start dome0
 134                                                          { 0x04, { 0, 255, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 135                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 136                                                                                          100, 0 },  //subdome1
 137                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 138                                                                                          100, 100, 0 },  //subdome2
 139                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 140                                                                                          100, 0 },   //subdome3
 141                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 142                                                                                          0 },  //subdome4
 143                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 144                                                                                          0 },  //subdome5
 145                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 146                                                                                          0 },  //subdome6
 147                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 148                                                                                          0 }    //subdome7
 149          
 150                                                          }  //end dome0
 151                                          }, // end big dome4
 152                                          { //start big dome4
 153                                          {  //start header0
 154                                                          "   FADE3", 0, 0x01 }, //end header0
 155                                                          {  //start dome0
 156                                                          { 0x04, { 0, 0, 255 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 157                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 158                                                                                          100, 0 },  //subdome1
 159                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 160                                                                                          100, 100, 0 },  //subdome2
 161                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 162                                                                                          100, 0 },   //subdome3
 163                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 164                                                                                          0 },  //subdome4
 165                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 166                                                                                          0 },  //subdome5
 167                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 168                                                                                          0 },  //subdome6
 169                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 170                                                                                          0 }    //subdome7
 171          
 172                                                          }  //end dome0
 173                                          },  // end big dome4
 174                                          { //start big dome4
 175                                          {  //start header0
 176                                                          "   FADE4", 0, 0x01 }, //end header0
 177                                                          {  //start dome0
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 4   

 178                                                          { 0x04, { 160, 32, 240 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 179                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 180                                                                                          100, 0 },  //subdome1
 181                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 182                                                                                          100, 100, 0 },  //subdome2
 183                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 184                                                                                          100, 0 },   //subdome3
 185                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 186                                                                                          0 },  //subdome4
 187                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 188                                                                                          0 },  //subdome5
 189                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 190                                                                                          0 },  //subdome6
 191                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 192                                                                                          0 }    //subdome7
 193          
 194                                                          }  //end dome0
 195                                          },  // end big dome4
 196                                          { //start big dome4
 197                                          {  //start header0
 198                                                          "   FADE5", 0, 0x01 }, //end header0
 199                                                          {  //start dome0
 200                                                          { 0x04, { 255, 165, 0 }, { 0, 0, 0 }, 1, 200, 100, 0 }, //subdome0
 201                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 202                                                                                          100, 0 },  //subdome1
 203                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 204                                                                                          100, 100, 0 },  //subdome2
 205                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 206                                                                                          100, 0 },   //subdome3
 207                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 208                                                                                          0 },  //subdome4
 209                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 210                                                                                          0 },  //subdome5
 211                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 212                                                                                          0 },  //subdome6
 213                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 214                                                                                          0 }    //subdome7
 215          
 216                                                          }  //end dome0
 217                                          },  // end big dome4
 218                                          { //start big dome4
 219                                          {  //start header0
 220                                                          "  SHARP1", 0, 0x01 }, //end header0
 221                                                          {  //start dome0
 222                                                          { 0x05, { 255, 0, 0 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 223                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 224                                                                                          100, 0 },  //subdome1
 225                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 226                                                                                          100, 100, 0 },  //subdome2
 227                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 228                                                                                          100, 0 },   //subdome3
 229                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 230                                                                                          0 },  //subdome4
 231                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 232                                                                                          0 },  //subdome5
 233                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 234                                                                                          0 },  //subdome6
 235                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 236                                                                                          0 }    //subdome7
 237          
 238                                                          }  //end dome0
 239                                          },  // end big dome4
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 5   

 240                                          { //start big dome4
 241                                          {  //start header0
 242                                                          "  SHARP2", 0, 0x01 }, //end header0
 243                                                          {  //start dome0
 244                                                          { 0x05, { 0, 255, 0 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 245                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 246                                                                                          100, 0 },  //subdome1
 247                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 248                                                                                          100, 100, 0 },  //subdome2
 249                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 250                                                                                          100, 0 },   //subdome3
 251                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 252                                                                                          0 },  //subdome4
 253                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 254                                                                                          0 },  //subdome5
 255                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 256                                                                                          0 },  //subdome6
 257                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 258                                                                                          0 }    //subdome7
 259          
 260                                                          }  //end dome0
 261                                          }, // end big dome4
 262                                          { //start big dome4
 263                                          {  //start header0
 264                                                          "  SHARP3", 0, 0x01 }, //end header0
 265                                                          {  //start dome0
 266                                                          { 0x05, { 0, 0, 255 }, { 0, 0, 0 }, 1, 100, 100, 100 }, //subdome0
 267                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 268                                                                                          100, 0 },  //subdome1
 269                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 270                                                                                          100, 100, 0 },  //subdome2
 271                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 272                                                                                          100, 0 },   //subdome3
 273                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 274                                                                                          0 },  //subdome4
 275                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 276                                                                                          0 },  //subdome5
 277                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 278                                                                                          0 },  //subdome6
 279                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 280                                                                                          0 }    //subdome7
 281          
 282                                                          }  //end dome0
 283                                          },  // end big dome4
 284                                          { //start big dome4
 285                                          {  //start header0
 286                                                          "  SHARP4", 0, 0x01 }, //end header0
 287                                                          {  //start dome0
 288                                                                          { 0x05, { 160, 32, 240 }, { 0, 0, 0 }, 1, 100,
 289                                                                                          100, 100 }, //subdome0
 290                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 291                                                                                          100, 0 },  //subdome1
 292                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 293                                                                                          100, 100, 0 },  //subdome2
 294                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 295                                                                                          100, 0 },   //subdome3
 296                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 297                                                                                          0 },  //subdome4
 298                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 299                                                                                          0 },  //subdome5
 300                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 301                                                                                          0 },  //subdome6
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 6   

 302                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 303                                                                                          0 }    //subdome7
 304          
 305                                                          }  //end dome0
 306                                          },  // end big dome4
 307                                          { //start big dome4
 308                                          {  //start header0
 309                                                          "  SHARP5", 0, 0x01 }, //end header0
 310                                                          {  //start dome0
 311                                                                          { 0x05, { 255, 165, 0 }, { 0, 0, 0 }, 1, 100,
 312                                                                                          100, 100 }, //subdome0
 313                                                                          { 0x13, { 0, 255, 0 }, { 160, 32, 240 }, 1, 100,
 314                                                                                          100, 100 },  //subdome1
 315                                                                          { 0x23, { 160, 32, 240 }, { 255, 255, 0 }, 1,
 316                                                                                          100, 100, 100 },  //subdome2
 317                                                                          { 0x33, { 255, 255, 0 }, { 255, 0, 0 }, 1, 100,
 318                                                                                          100, 0 },   //subdome3
 319                                                                          { 0x44, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 320                                                                                          0 },  //subdome4
 321                                                                          { 0x54, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 322                                                                                          0 },  //subdome5
 323                                                                          { 0x64, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 324                                                                                          0 },  //subdome6
 325                                                                          { 0x74, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 326                                                                                          0 }    //subdome7
 327          
 328                                                          }  //end dome0
 329                                          }, // end big dome4
 330                                          { //start big dome4
 331                                          {  //start header0
 332                                                          " GRADIEN", 0, 0x07 }, //end header0
 333                                                          {  //start dome0
 334                                                                          { 0x03, { 255, 0, 0 }, { 255, 0x7F, 0 }, 1, 100,
 335                                                                                          100, 0 }, //subdome0
 336                                                                          { 0x13, { 255, 0x7F, 0 }, { 255, 255, 0 }, 1,
 337                                                                                          100, 100, 0 },  //subdome1
 338                                                                          { 0x23, { 255, 255, 0 }, { 0, 255, 0 }, 1, 100,
 339                                                                                          100, 0 },  //subdome2
 340                                                                          { 0x33, { 0, 255, 0 }, { 0, 255, 255 }, 1, 100,
 341                                                                                          100, 0 },   //subdome3
 342                                                                          { 0x43, { 0, 255, 255 }, { 0, 0, 255 }, 1, 100,
 343                                                                                          100, 0 },  //subdome4
 344                                                                          { 0x53, { 0, 0, 255 }, { 0x8B, 0, 255 }, 1, 100,
 345                                                                                          100, 0 },  //subdome5
 346                                                                          { 0x63, { 0x8B, 0, 255 }, { 255, 0, 0 }, 1, 100,
 347                                                                                          100, 0 },  //subdome6
 348                                                                          { 0x73, { 0, 0, 255 }, { 0, 0, 0 }, 4, 200, 100,
 349                                                                                          0 }    //subdome7
 350          
 351                                                          }  //end dome0
 352                                          }  // end big dome4
 353                          };
 354          
 355          //////////////////
 356          void app_dome_start(uint8_t index);
 357          void app_dome_Init(void) {
 358   1      
 359   1              memset((uint8_t *) &subDome_Assist, 0, sizeof(subDome_Assist));
 360   1      
 361   1              memset((uint8_t *) &domePro, 0, sizeof(domePro));
 362   1      
 363   1              app_dome_start(0);
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 7   

 364   1      
 365   1      }
 366          void app_dome_previous(void) {
 367   1              if (domePro.currentDomeIndex) {
 368   2                      domePro.currentDomeIndex--;
 369   2              } else {
 370   2                      domePro.currentDomeIndex = DEFAULT_DOME_NUM - 1;
 371   2              }
 372   1              app_dome_start(domePro.currentDomeIndex);
 373   1      }
 374          void app_dome_next(void) {
 375   1              domePro.currentDomeIndex++;
 376   1              if (domePro.currentDomeIndex >= DEFAULT_DOME_NUM) {
 377   2                      domePro.currentDomeIndex = 0;
 378   2              }
 379   1      
 380   1              app_dome_start(domePro.currentDomeIndex);
 381   1      
 382   1      }
 383          
 384          void app_dome_get_current_Name(char *name, uint8_t len) {
 385   1              if (len > sizeof(dome_default[domePro.currentDomeIndex].header.name)) {
 386   2                      name = 0;
 387   2                      return;
 388   2              }
 389   1              memcpy((uint8_t *) name,
 390   1                              (uint8_t *) dome_default[domePro.currentDomeIndex].header.name,
 391   1                              len);
 392   1      }
 393          void app_dome_start_current(void) {
 394   1      
 395   1              app_dome_start(domePro.currentDomeIndex);
 396   1      
 397   1      }
 398          void app_dome_stop_current(void) {
 399   1      
 400   1              subDome.repeate = 0;
 401   1              subDome.offtime = 0;
 402   1              Light_RGB_set(0, 0, 0);
 403   1      
 404   1      }
 405          void app_dome_single_cycle(uint8_t subIndex) {
 406   1              if ((dome_default[domePro.currentDomeIndex].header.repeat_number & 0x0F)
 407   1                              == (subIndex + 1)) {
 408   2                      subIndex = 0;
 409   2                      memcpy((uint8_t*) &subDome,
 410   2                                      (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[subIndex],
 411   2                                      sizeof(subDome));
 412   2              } else {
 413   2                      memcpy((uint8_t*) &subDome,
 414   2                                      (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[subIndex
 415   2                                                      + 1], sizeof(subDome));
 416   2              }
 417   1      
 418   1              memcpy((uint8_t*) &domeHeader,
 419   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].header,
 420   1                              sizeof(domeHeader));
 421   1      
 422   1      }
 423          void app_dome_start(uint8_t domeIndex) {
 424   1              subDome_Assist.switch_flag = 0;
 425   1              subDome_Assist.msCnt = 0;
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 8   

 426   1              subDome_Assist.stopTime = 50;
 427   1      
 428   1      //      app_dome_single_cycle(domeIndex);
 429   1      
 430   1              domePro.currentDomeIndex = domeIndex;
 431   1      
 432   1              memcpy((uint8_t*) &subDome,
 433   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].subdome[0],
 434   1                              sizeof(subDome));
 435   1      
 436   1              memcpy((uint8_t*) &domeHeader,
 437   1                              (uint8_t*) &dome_default[domePro.currentDomeIndex].header,
 438   1                              sizeof(domeHeader));
 439   1      
 440   1      }
 441          
 442          static void app_dome_subDome_pro(uint8_t subIndex) {
 443   1              subDome_Assist.switch_flag = 0;
 444   1              subDome_Assist.msCnt = 0;
 445   1              subDome_Assist.stopTime = 0;
 446   1      
 447   1              app_dome_single_cycle(subIndex);
 448   1      
 449   1      }
 450          
 451          static uint32_t tmp = 0;
 452          static uint8_t tmp_color = 0;
 453          
 454          void app_dome_interrupter(void) {
 455   1      
 456   1      #if 1
 457   1      
 458   1              if (subDome_Assist.stopTime) {
 459   2                      subDome_Assist.stopTime--;
 460   2                      return;
 461   2              }
 462   1      
 463   1              if ((subDome.repeate == 0) && (subDome.offtime == 0)) {
 464   2                      return;
 465   2              }
 466   1      
 467   1              switch (subDome.mode & 0x0F) {
 468   2              case 0x03:  //shadow
 469   2              {
 470   3                      subDome_Assist.msCnt++;
 471   3                      if (subDome.color1.R < subDome.color2.R) {
 472   4                              tmp = subDome.color1.R * 256
 473   4                                              + subDome_Assist.msCnt * 256
 474   4                                                              * abs(subDome.color2.R - subDome.color1.R)
 475   4                                                              / subDome.speed;
 476   4                              tmp = subDome.bright * tmp / 100;
 477   4                              Light_Red_set(tmp & 0xFFFF);
 478   4                      } else {
 479   4                              tmp = subDome.color1.R * 256
 480   4                                              - subDome_Assist.msCnt * 256
 481   4                                                              * abs(subDome.color2.R - subDome.color1.R)
 482   4                                                              / subDome.speed;
 483   4                              tmp = subDome.bright * tmp / 100;
 484   4                              Light_Red_set(tmp);
 485   4                      }
 486   3                      //////
 487   3                      if (subDome.color1.G < subDome.color2.G) {
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 9   

 488   4                              tmp = subDome.color1.G * 256
 489   4                                              + subDome_Assist.msCnt * 256
 490   4                                                              * abs(subDome.color2.G - subDome.color1.G)
 491   4                                                              / subDome.speed;
 492   4                              tmp = subDome.bright * tmp / 100;
 493   4                              Light_Green_set(tmp);
 494   4                      } else {
 495   4                              tmp = subDome.color1.G * 256
 496   4                                              - subDome_Assist.msCnt * 256
 497   4                                                              * abs(subDome.color2.G - subDome.color1.G)
 498   4                                                              / subDome.speed;
 499   4                              tmp = subDome.bright * tmp / 100;
 500   4                              Light_Green_set(tmp);
 501   4                      }
 502   3                      //////
 503   3                      if (subDome.color1.B < subDome.color2.B) {
 504   4                              tmp = subDome.color1.B * 256
 505   4                                              + subDome_Assist.msCnt * 256
 506   4                                                              * abs(subDome.color2.B - subDome.color1.B)
 507   4                                                              / subDome.speed;
 508   4                              tmp = subDome.bright * tmp / 100;
 509   4                              Light_Blue_set(tmp);
 510   4                      } else {
 511   4                              tmp = subDome.color1.B * 256
 512   4                                              - subDome_Assist.msCnt * 256
 513   4                                                              * abs(subDome.color2.B - subDome.color1.B)
 514   4                                                              / subDome.speed;
 515   4                              tmp = subDome.bright * tmp / 100;
 516   4                              Light_Blue_set(tmp);
 517   4                      }
 518   3      
 519   3                      if (subDome_Assist.msCnt >= subDome.speed) {
 520   4                              subDome_Assist.msCnt = 0;
 521   4      #if 0
                                      tmp_color = subDome.color2.R;
                                      subDome.color2.R = subDome.color1.R;
                                      subDome.color1.R = tmp_color;
              
                                      tmp_color = subDome.color2.G;
                                      subDome.color2.G = subDome.color1.G;
                                      subDome.color1.G = tmp_color;
              
                                      tmp_color = subDome.color2.B;
                                      subDome.color2.B = subDome.color1.B;
                                      subDome.color1.B = tmp_color;
              
                                      if (subDome_Assist.switch_flag == 0) {
                                              subDome_Assist.switch_flag = 1;
              
                                      } else {
                                              subDome_Assist.switch_flag = 0;
              
                                              if (subDome.repeate) {
                                                      subDome.repeate--;
                                              }
                                      }
              #else
 545   4      
 546   4                              if (subDome.repeate) {
 547   5                                      subDome.repeate--;
 548   5                              }
 549   4      
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 10  

 550   4      #endif
 551   4                      }
 552   3                      if (subDome.repeate == 0) {
 553   4      //                      Light_RGB_set(0, 0, 0);
 554   4      
 555   4                              if (subDome.offtime) {
 556   5                                      subDome.offtime--;
 557   5                              }
 558   4                              if (subDome.offtime == 0) {
 559   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 560   5                              }
 561   4      
 562   4                      }
 563   3              }
 564   2                      break;
 565   2              case 0x04:  //breath
 566   2              {
 567   3                      if (subDome_Assist.switch_flag == 0) {
 568   4                              subDome_Assist.msCnt++;
 569   4                      } else {
 570   4                              if (subDome_Assist.msCnt) {
 571   5                                      subDome_Assist.msCnt--;
 572   5                              }
 573   4                      }
 574   3      
 575   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.R / subDome.speed;
 576   3                      tmp = tmp * subDome.bright / 100;
 577   3                      Light_Red_set(tmp & 0xFFFF);
 578   3      
 579   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.G / subDome.speed;
 580   3                      tmp = tmp * subDome.bright / 100;
 581   3                      Light_Green_set(tmp & 0xFFFF);
 582   3      
 583   3                      tmp = 0xFF * subDome_Assist.msCnt * subDome.color1.B / subDome.speed;
 584   3                      tmp = tmp * subDome.bright / 100;
 585   3                      Light_Blue_set(tmp & 0xFFFF);
 586   3      
 587   3                      if ((subDome_Assist.msCnt >= subDome.speed)
 588   3                                      || (subDome_Assist.msCnt == 0)) {
 589   4                              if (subDome_Assist.switch_flag == 0) {
 590   5                                      subDome_Assist.switch_flag = 1;
 591   5                              } else {
 592   5                                      subDome_Assist.switch_flag = 0;
 593   5                                      if (subDome.repeate) {
 594   6                                              subDome.repeate--;
 595   6                                      }
 596   5                              }
 597   4                      }
 598   3                      if (subDome.repeate == 0) {
 599   4      //                      Light_RGB_set(0, 0, 0);
 600   4                              if (subDome.offtime) {
 601   5                                      subDome.offtime--;
 602   5                              }
 603   4                              if (subDome.offtime == 0) {
 604   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 605   5                              }
 606   4                      }
 607   3              }
 608   2                      break;
 609   2              case 0x05:  //blink
 610   2              {
 611   3                      uint32_t tt = 0xFF;
C51 COMPILER V9.56.0.0   APP_DOME                                                          10/29/2017 19:23:14 PAGE 11  

 612   3                      if (subDome_Assist.msCnt == 0) {
 613   4                              tmp = tt * subDome.color1.R * subDome.bright / 100;
 614   4                              Light_Red_set(tmp & 0xFFFF);
 615   4      
 616   4                              tmp = tt * subDome.color1.G * subDome.bright / 100;
 617   4                              Light_Green_set(tmp & 0xFFFF);
 618   4      
 619   4                              tmp = tt * subDome.color1.B * subDome.bright / 100;
 620   4                              Light_Blue_set(tmp & 0xFFFF);
 621   4                      }
 622   3                      if (subDome_Assist.msCnt == (uint32_t) subDome.speed) {
 623   4                              tmp = tt * subDome.color2.R * subDome.bright / 100;
 624   4                              Light_Red_set(tmp & 0xFFFF);
 625   4      
 626   4                              tmp = tt * subDome.color2.G * subDome.bright / 100;
 627   4                              Light_Green_set(tmp & 0xFFFF);
 628   4      
 629   4                              tmp = tt * subDome.color2.B * subDome.bright / 100;
 630   4                              Light_Blue_set(tmp & 0xFFFF);
 631   4                      }
 632   3                      subDome_Assist.msCnt++;
 633   3                      if (subDome_Assist.msCnt >= (subDome.speed + subDome.offtime)) {
 634   4                              subDome_Assist.msCnt = 0;
 635   4      
 636   4                              if (subDome.repeate) {
 637   5                                      subDome.repeate--;
 638   5                              }
 639   4      
 640   4                      }
 641   3                      if (subDome.repeate == 0) {
 642   4      //                      Light_RGB_set(0, 0, 0);
 643   4                              if (subDome.offtime) {
 644   5                                      subDome.offtime--;
 645   5                              }
 646   4                              if (subDome.offtime == 0) {
 647   5                                      app_dome_subDome_pro(subDome.mode >> 4);
 648   5                              }
 649   4                      }
 650   3              }
 651   2                      break;
 652   2              default:
 653   2      
 654   2                      break;
 655   2              }
 656   1      
 657   1      #endif
 658   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2803    ----
   CONSTANT SIZE    =   1710    ----
   XDATA SIZE       =     22       8
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =     13    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
